# Rust — Задание №2

## CLI + Library: текстовые утилиты

Это второе задание в рамках Rust-практики.  
Оно продолжает первое задание и соответствует общей **Rust Backend Roadmap**:

- идиоматичный Rust
- чистая архитектура
- ошибки, тесты, работа с I/O
- минимум магии, максимум понимания

---

## Цель задания

Сделать небольшой, но “взрослый” проект:

- библиотека с чистым API
- CLI как тонкая оболочка
- тесты (unit + integration)
- аккуратная работа со строками и файлами

---

## Проект

Название (рекомендуемое): `textkit`  
(можно выбрать другое)

Структура:

```text
textkit/
├── Cargo.toml
├── README.md
├── src/
│   ├── lib.rs
│   ├── main.rs
│   ├── error.rs
│   ├── stats.rs
│   ├── uniq.rs
│   └── grep.rs
└── tests/
    └── cli.rs
```

1. Архитектура
   • lib.rs — вся логика, чистые функции
   • никаких println!
   • никаких stdin внутри
   • main.rs — только:
   • парсинг аргументов
   • вызов функций из lib
   • вывод результата

Принцип: thin main, fat lib

2. Команды CLI
1. textkit stats <path>

Читает файл и выводит:
• количество строк
• количество слов
• количество символов:
• байты
• Unicode scalar values (chars().count())

Формат вывода — на твой выбор, но:
• стабильный
• пригодный для тестирования

Пример (не обязательный):

```bash
  lines: 10
  words: 42
  bytes: 256
  chars: 240
```

2. textkit uniq <path>

Аналог uniq.

Поведение:
• по умолчанию — схлопывает подряд идущие одинаковые строки
• флаг --all:
• делает уникальность по всему файлу
• сохраняет порядок первых вхождений

3. textkit grep <pattern> <path>

Простой grep:
• печатает строки, содержащие pattern

Флаги:
• -n, --line-number — печатать номер строки
• -i, --ignore-case — case-insensitive (ASCII достаточно)

Ошибки

В библиотеке должен быть единый тип ошибок:

```Rust
pub enum TextkitError {
    Io(std::io::Error),
    InvalidArgument(String),
    // ...
}
```

Требования:
• понятные сообщения
• ошибки не должны panic!
• thiserror можно использовать, но не обязательно

Тесты

Unit-тесты
• минимум 8
• тестируют функции из lib

Integration-тесты
• минимум 2
• тестируют CLI
• рекомендуется:
• assert_cmd
• predicates

Команда должна проходить

```
cargo test
```

Инженерные ограничения
• можно использовать clap для CLI (рекомендуется)
• можно парсить аргументы руками — если аккуратно
• никакого async
• никакого tokio
• всё синхронно и прозрачно

Acceptance Criteria

Перед сдачей проект должен проходить:

```Rust
    cargo fmt
    cargo clippy -- -D warnings
    cargo test
```

В README.md должны быть:
• краткое описание проекта
• примеры запуска всех команд
• примеры с флагами

Что сдавать 1. Ссылку на GitHub-репозиторий (или ветку) 2. Подтверждение, что выполнены команды:
• cargo fmt
• cargo clippy -- -D warnings
• cargo test
